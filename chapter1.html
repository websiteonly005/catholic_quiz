<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Catholic Bible Quiz - 1 Corinthians Ch.1</title>
    <style>
        :root {
            --primary-color: #0066cc;
            --bg-color: #f0f2f5;
            --correct-bg: #d4edda;
            --correct-text: #155724;
            --wrong-bg: #f8d7da;
            --wrong-text: #721c24;
            --card-radius: 12px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 15px;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding-bottom: 50px;
        }

        /* Top Bar for Language Switch */
        .top-bar {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 15px;
        }

        .lang-switch {
            background: #0066cc;
            color: white;
            border: none;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            font-weight: 500;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* Views Utility */
        .view-hidden {
            display: none !important;
        }

        /* --- Welcome View Styles --- */
        .welcome-card {
            background: white;
            padding: 30px 20px;
            border-radius: var(--card-radius);
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            animation: fadeIn 0.4s ease;
        }

        .welcome-title {
            color: #2c3e50;
            font-size: 1.6rem;
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            color: #666;
            margin-bottom: 30px;
        }

        .difficulty-menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .diff-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-left: 25px;
            padding-right: 25px;
        }

        .diff-btn:active {
            transform: scale(0.98);
        }

        /* Difficulty Colors */
        .diff-btn.easy { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); box-shadow: 0 4px 10px rgba(79, 172, 254, 0.3); }
        .diff-btn.medium { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); box-shadow: 0 4px 10px rgba(253, 160, 133, 0.3); color: #fff; text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .diff-btn.hard { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); box-shadow: 0 4px 10px rgba(235, 51, 73, 0.3); }
        .diff-btn.all { background: white; color: #444; border: 2px solid #eee; }

        /* --- Quiz View Styles --- */
        .quiz-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .back-btn {
            background: transparent;
            border: none;
            color: #0066cc;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            padding: 5px 10px;
            margin-left: -10px;
        }

        .mode-label {
            font-weight: bold;
            color: #555;
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        /* Card Styles */
        .card {
            background: white;
            border-radius: var(--card-radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .question-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: #1a1a1a;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        button.option-btn {
            background: #fff;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 12px 15px;
            text-align: left;
            font-size: 1rem;
            color: #444;
            cursor: pointer;
            width: 100%;
            transition: all 0.2s;
            -webkit-tap-highlight-color: transparent;
            line-height: 1.4;
        }

        button.option-btn:active {
            background-color: #e2e6ea;
        }

        /* Answer Status Styles */
        button.option-btn.correct {
            background-color: var(--correct-bg);
            border-color: #c3e6cb;
            color: var(--correct-text);
            font-weight: 500;
        }

        button.option-btn.wrong {
            background-color: var(--wrong-bg);
            border-color: #f5c6cb;
            color: var(--wrong-text);
            opacity: 0.7;
        }

        .feedback-box {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.95rem;
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .feedback-box.show-correct {
            display: block;
            background-color: var(--correct-bg);
            color: var(--correct-text);
            border: 1px solid #c3e6cb;
        }

        .feedback-box.show-wrong {
            display: block;
            background-color: var(--wrong-bg);
            color: var(--wrong-text);
            border: 1px solid #f5c6cb;
        }

        .explanation-text {
            margin-top: 8px;
            font-size: 0.9rem;
            border-top: 1px solid rgba(0,0,0,0.1);
            padding-top: 8px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 0.8rem;
            color: #999;
        }
    </style>
</head>
<body>

<div class="container">
    
    <!-- Top Bar -->
    <div class="top-bar">
        <button class="lang-switch" onclick="toggleLanguage()">English</button>
    </div>

    <!-- VIEW 1: Welcome / Difficulty Selection -->
    <div id="welcome-view">
        <div class="welcome-card">
            <h1 class="welcome-title" id="txt-title">格林多前书测验</h1>
            <p class="welcome-subtitle" id="txt-subtitle">第一章：分裂与十字架的道理</p>
            
            <p style="text-align: left; font-weight: bold; margin-bottom: 15px; color:#444;" id="txt-select-diff">请选择难度：</p>
            
            <div class="difficulty-menu">
                <button class="diff-btn easy" onclick="startQuiz('easy')">
                    <span id="btn-easy">简单</span> <span>★ 10题</span>
                </button>
                <button class="diff-btn medium" onclick="startQuiz('medium')">
                    <span id="btn-medium">中等</span> <span>★★ 10题</span>
                </button>
                <button class="diff-btn hard" onclick="startQuiz('hard')">
                    <span id="btn-hard">困难</span> <span>★★★ 10题</span>
                </button>
                <button class="diff-btn all" onclick="startQuiz('all')">
                    <span id="btn-all">所有题目</span> <span>30题</span>
                </button>
            </div>
        </div>
        <div class="footer" id="txt-footer-1">天主教圣经测验</div>
    </div>

    <!-- VIEW 2: Quiz List -->
    <div id="quiz-view" class="view-hidden">
        <div class="quiz-header">
            <button class="back-btn" onclick="goBack()" id="btn-back">← 返回</button>
            <span class="mode-label" id="lbl-mode"></span>
        </div>

        <div id="quiz-list">
            <!-- Questions injected here -->
        </div>
        
        <div class="footer" id="txt-footer-2">天主教圣经测验</div>
    </div>

</div>

<script>
    // --- State ---
    let currentLang = 'zh';
    let currentDifficulty = null; 
    let userAnswers = {}; 

    // --- Resources ---
    const uiText = {
        zh: {
            title: "格林多前书测验",
            subtitle: "第一章：分裂与十字架的道理",
            selectDiff: "请选择难度：",
            btnEasy: "简单",
            btnMedium: "中等",
            btnHard: "困难",
            btnAll: "所有题目",
            btnBack: "← 返回主页",
            footer: "天主教圣经测验",
            langBtn: "English",
            correct: "✓ 回答正确！",
            wrong: "✗ 回答错误。",
            correctIs: "正确答案是：",
            noteTitle: "解析："
        },
        en: {
            title: "1 Corinthians Quiz",
            subtitle: "Chapter 1: Divisions & The Cross",
            selectDiff: "Select Difficulty:",
            btnEasy: "Easy",
            btnMedium: "Medium",
            btnHard: "Hard",
            btnAll: "All Questions",
            btnBack: "← Back Home",
            footer: "Catholic Bible Quiz",
            langBtn: "中文",
            correct: "✓ Correct!",
            wrong: "✗ Incorrect.",
            correctIs: "The correct answer is:",
            noteTitle: "Note:"
        }
    };

    // --- Questions Data (10 Easy, 10 Medium, 10 Hard) ---
    const questionsData = [
        // --- EASY QUESTIONS (1-10) ---
        { id: 1, diff: 'easy', correct: 0, zh: { q: "1. 保禄在书信的开头自称是奉天主的旨意蒙召做什么？", options: ["耶稣基督的宗徒", "格林多教会的主教", "一位普通的先知", "罗马的公民"], note: "第1节：'奉天主的旨意，蒙召为耶稣基督宗徒的保禄'。" }, en: { q: "1. Paul calls himself what by the will of God?", options: ["An apostle of Christ Jesus", "The Bishop of Corinth", "A simple prophet", "A citizen of Rome"], note: "Verse 1: 'Paul, called to be an apostle of Christ Jesus'." } },
        { id: 11, diff: 'easy', correct: 1, zh: { q: "2. 这封信是写给哪里的教会？", options: ["罗马", "格林多", "厄弗所", "迦拉达"], note: "第2节：'致书给在格林多的天主教会'。" }, en: { q: "2. To which church is this letter addressed?", options: ["Rome", "Corinth", "Ephesus", "Galatia"], note: "Verse 2: 'To the church of God that is in Corinth'." } },
        { id: 8, diff: 'easy', correct: 1, zh: { q: "3. 我们所宣讲的是怎样的基督？", options: ["复活的基督", "被钉在十字架上的基督", "行奇迹的基督", "身为君王的基督"], note: "第23节：'我们却宣讲被钉在十字架上的基督'。" }, en: { q: "3. What kind of Christ do we proclaim?", options: ["Risen Christ", "Christ crucified", "Miracle Worker", "King"], note: "Verse 23: 'Proclaim Christ crucified'." } },
        { id: 14, diff: 'easy', correct: 0, zh: { q: "4. 在第一节中，谁被称为“我们的弟兄”并与保禄一同署名？", options: ["索斯德尼", "巴尔纳伯", "弟茂德", "路加"], note: "第1节：'同我们的弟兄索斯德尼'。" }, en: { q: "4. Who is called 'our brother' and named with Paul in verse 1?", options: ["Sosthenes", "Barnabas", "Timothy", "Luke"], note: "Verse 1: 'And our brother Sosthenes'." } },
        { id: 16, diff: 'easy', correct: 2, zh: { q: "5. 保禄祝愿恩宠与平安由谁而来？", options: ["只由天主父", "只由主耶稣", "由天主父及主耶稣基督", "由圣神"], note: "第3节：'由我们的父天主及主耶稣基督，赐给你们。'" }, en: { q: "5. From whom does Paul wish grace and peace?", options: ["God the Father only", "Lord Jesus only", "God our Father and the Lord Jesus Christ", "The Holy Spirit"], note: "Verse 3: 'From God our Father and the Lord Jesus Christ'." } },
        { id: 17, diff: 'easy', correct: 0, zh: { q: "6. 保禄为了格林多人感谢天主的频率是？", options: ["时常", "偶尔", "仅在主日", "仅在祈祷时"], note: "第4节：'我时常为你们感谢我的天主。'" }, en: { q: "6. How often does Paul thank God for the Corinthians?", options: ["Always", "Occasionally", "Only on Sundays", "Only during prayer"], note: "Verse 4: 'I give thanks to my God always for you'." } },
        { id: 18, diff: 'easy', correct: 3, zh: { q: "7. 保禄在第9节说天主具有什么特质？", options: ["严厉的", "遥远的", "不可知的", "忠信的"], note: "第9节：'天主是忠信的。'" }, en: { q: "7. What quality does Paul attribute to God in verse 9?", options: ["Strict", "Distant", "Unknowable", "Faithful"], note: "Verse 9: 'God is faithful'." } },
        { id: 19, diff: 'easy', correct: 1, zh: { q: "8. 面对教会的分裂，保禄质问：“基督____了吗？”", options: ["复活", "被分割", "降临", "发怒"], note: "第13节：'基督被分割了吗？'" }, en: { q: "8. Facing division, Paul asks: 'Is Christ ____?'", options: ["Risen", "Divided", "Coming", "Angry"], note: "Verse 13: 'Is Christ divided?'" } },
        { id: 20, diff: 'easy', correct: 2, zh: { q: "9. 除史德法纳一家外，保禄特别提到给克利斯颇和谁施了洗？", options: ["伯多禄", "巴尔纳伯", "盖犹", "路加"], note: "第14节：'除了克利斯颇和盖犹外，我没有给你们中任何人施过洗。'" }, en: { q: "9. Besides Stephanas, Paul mentions baptizing Crispus and whom?", options: ["Peter", "Barnabas", "Gaius", "Luke"], note: "Verse 14: 'I baptized none of you except Crispus and Gaius'." } },
        { id: 21, diff: 'easy', correct: 1, zh: { q: "10. 对于蒙召的人，基督是天主的德能和天主的____？", options: ["公义", "智慧", "慈悲", "法律"], note: "第24节：'基督却是天主的德能和天主的智慧。'" }, en: { q: "10. To those called, Christ is the power of God and the ____ of God?", options: ["Justice", "Wisdom", "Mercy", "Law"], note: "Verse 24: 'Christ the power of God and the wisdom of God'." } },

        // --- MEDIUM QUESTIONS (11-20) ---
        { id: 2, diff: 'medium', correct: 1, zh: { q: "1. 谁向保禄报告了格林多教会内部发生的争执？", options: ["阿颇罗", "克洛厄家的人", "伯多禄", "弟茂德"], note: "第11节：'因为我有克洛厄家的人...说你们中间有纷争。'" }, en: { q: "1. Who reported the quarrels to Paul?", options: ["Apollos", "Chloe's people", "Peter", "Timothy"], note: "Verse 11: 'Reported... by Chloe's people'." } },
        { id: 3, diff: 'medium', correct: 2, zh: { q: "2. 格林多教友当时的口号不包括下列哪一句？", options: ["「我是属保禄的」", "「我是属阿颇罗的」", "「我是属梅瑟的」", "「我是属基督的」"], note: "第12节未提到'属梅瑟的'。" }, en: { q: "2. Which was NOT a slogan used by them?", options: ["'I belong to Paul'", "'I belong to Apollos'", "'I belong to Moses'", "'I belong to Christ'"], note: "Verse 12 does not mention Moses." } },
        { id: 12, diff: 'medium', correct: 0, zh: { q: "3. 保禄提到他曾给谁施过洗（除了克利斯颇和盖犹外）？", options: ["史德法纳一家", "阿颇罗", "提多", "巴尔纳伯"], note: "第16节：'我还没给史德法纳一家施过洗'。" }, en: { q: "3. Who else did Paul baptize besides Crispus and Gaius?", options: ["The household of Stephanas", "Apollos", "Titus", "Barnabas"], note: "Verse 16: 'I did baptize also the household of Stephanas'." } },
        { id: 4, diff: 'medium', correct: 1, zh: { q: "4. 保禄说基督派遣他来，主要不是为了施洗，而是为了做什么？", options: ["行奇迹", "宣传福音", "管理财务", "审判罪人"], note: "第17节：'不是为施洗，而是为宣传福音'。" }, en: { q: "4. Christ sent Paul not to baptize but to do what?", options: ["Perform miracles", "Preach the Gospel", "Manage finances", "Judge sinners"], note: "Verse 17: 'Not to baptize but to preach the gospel'." } },
        { id: 7, diff: 'medium', correct: 3, zh: { q: "5. “犹太人要求神迹”，那希腊人寻求什么？", options: ["法律", "财富", "权力", "智慧"], note: "第22节：'希腊人寻求智慧'。" }, en: { q: "5. 'Jews demand signs', but what do Greeks look for?", options: ["Law", "Wealth", "Power", "Wisdom"], note: "Verse 22: 'Greeks look for wisdom'." } },
        { id: 10, diff: 'medium', correct: 2, zh: { q: "6. “凡要夸耀的，应当因谁而夸耀”？", options: ["因自己的善行", "因教会的领袖", "因主", "因所得的恩赐"], note: "第31节：'凡要夸耀的，应因主而夸耀'。" }, en: { q: "6. 'Whoever boasts, should boast in whom'?", options: ["Good works", "Leaders", "The Lord", "Gifts"], note: "Verse 31: 'Boast in the Lord'." } },
        { id: 22, diff: 'medium', correct: 0, zh: { q: "7. 保禄说因为在基督内，他们在一切事上，在一切言论和____上，都富有了。", options: ["知识", "金钱", "权力", "情感"], note: "第5节：'在一切言论和知识上，都富有了。'" }, en: { q: "7. Paul says in Christ they were enriched in all speech and all ____?", options: ["Knowledge", "Money", "Power", "Emotion"], note: "Verse 5: 'Enriched in him in all speech and all knowledge'." } },
        { id: 23, diff: 'medium', correct: 1, zh: { q: "8. 保禄说他们已不缺少任何恩赐，只待什么时刻？", options: ["去天堂的时刻", "主耶稣基督的显现", "世界的末日", "保禄的再次到来"], note: "第7节：'已不缺少任何恩赐，只待我们的主耶稣基督的显现。'" }, en: { q: "8. Paul says they are not lacking in any gift, as they wait for what?", options: ["Going to heaven", "The revealing of our Lord Jesus", "The end of the world", "Paul's return"], note: "Verse 7: 'Wait for the revealing of our Lord Jesus Christ'." } },
        { id: 24, diff: 'medium', correct: 3, zh: { q: "9. 保禄劝勉他们要说什么话，并在什么上合而为一？", options: ["同一本圣经", "同一个教会", "同一种语言", "同一的心意和见解"], note: "第10节：'大家要说一样的话...在同一的心意和同一的见解上，和衷共济。'" }, en: { q: "9. Paul urges them to be united in the same mind and the same ____?", options: ["Bible", "Church", "Language", "Judgment/Purpose"], note: "Verse 10: 'United in the same mind and the same judgment'." } },
        { id: 25, diff: 'medium', correct: 0, zh: { q: "10. 保禄反问：天主岂不是使这个世界的____变成了愚妄吗？", options: ["智慧", "财富", "荣耀", "法律"], note: "第20节：'天主岂不是使这个世界的智慧变成了愚妄吗？'" }, en: { q: "10. Paul asks: 'Has not God made foolish the _____ of the world?'", options: ["Wisdom", "Wealth", "Glory", "Law"], note: "Verse 20: 'Has not God made foolish the wisdom of the world?'" } },

        // --- HARD QUESTIONS (21-30) ---
        { id: 5, diff: 'hard', correct: 0, zh: { q: "1. 保禄强调宣讲时不用“智慧的言辞”，是恐怕什么落了空？", options: ["基督的十字架", "他自己的名声", "教会的奉献", "法律的效力"], note: "第17节：'免得基督的十字架失去效力'。" }, en: { q: "1. Paul avoided 'words of wisdom' lest what be emptied of power?", options: ["The cross of Christ", "His reputation", "Church offerings", "The Law"], note: "Verse 17: '...so that the cross of Christ might not be emptied of its meaning'." } },
        { id: 6, diff: 'hard', correct: 2, zh: { q: "2. 十字架的道理对那些丧亡的人来说是什么？", options: ["天主的德能", "最高的智慧", "愚妄", "神秘的知识"], note: "第18节：'为丧亡的人是愚妄'。" }, en: { q: "2. What is the message of the cross to those perishing?", options: ["God's power", "Highest wisdom", "Foolishness", "Secret knowledge"], note: "Verse 18: 'Foolishness to those who are perishing'." } },
        { id: 9, diff: 'hard', correct: 0, zh: { q: "3. 天主偏偏选了世上愚妄的，为羞辱谁？", options: ["那有智慧的", "那富有的", "那有权势的", "那虔诚的"], note: "第27节：'为羞辱那有智慧的'。" }, en: { q: "3. God chose the foolish to shame whom?", options: ["The wise", "The wealthy", "The powerful", "The pious"], note: "Verse 27: 'To shame the wise'." } },
        { id: 13, diff: 'hard', correct: 2, zh: { q: "4. 根据第30节，基督成为了我们的智慧、正义、圣洁以及什么？", options: ["力量", "喜乐", "救赎", "平安"], note: "第30节：'成了我们的智慧、正义、圣洁与救赎'。" }, en: { q: "4. Acc. to v30, Christ became our wisdom, righteousness, sanctification, and?", options: ["Power", "Joy", "Redemption", "Peace"], note: "Verse 30: '...sanctification and redemption'." } },
        { id: 15, diff: 'hard', correct: 1, zh: { q: "5. 保禄说“我要摧毁智者的智慧”是引用了哪里的经文？", options: ["旧约法律", "经上（依撒意亚先知书）", "希腊哲学", "耶稣的教导"], note: "第19节引用了《依撒意亚》29:14。" }, en: { q: "5. Where is 'I will destroy the wisdom of the wise' quoted from?", options: ["The Law", "Scripture (Isaiah)", "Greek Philosophy", "Jesus"], note: "Verse 19 quotes Isaiah 29:14." } },
        { id: 26, diff: 'hard', correct: 3, zh: { q: "6. 保禄提到基督会坚固信徒到底，使他们在什么日子无瑕可指？", options: ["受洗的日子", "死亡的日子", "复活的日子", "我们主耶稣基督的日子"], note: "第8节：'在我们主耶稣基督的日子上，无瑕可指。'" }, en: { q: "6. Paul says Christ will sustain them so they are guiltless in the day of...?", options: ["Baptism", "Death", "Resurrection", "Our Lord Jesus Christ"], note: "Verse 8: 'Guiltless in the day of our Lord Jesus Christ'." } },
        { id: 27, diff: 'hard', correct: 2, zh: { q: "7. 根据第21节，因为世人凭智慧不认识天主，天主遂决定借着什么来拯救信徒？", options: ["更多智慧", "律法的行为", "宣讲的愚妄", "神秘的经验"], note: "第21节：'借着宣讲的愚妄，拯救信徒。'" }, en: { q: "7. Since the world did not know God through wisdom, God decided to save believers through...?", options: ["More wisdom", "Works of law", "The folly of what we preach", "Mystical experience"], note: "Verse 21: 'Through the folly of what we preach to save those who believe'." } },
        { id: 28, diff: 'hard', correct: 0, zh: { q: "8. 填空题：天主的愚妄总比人____。", options: ["智慧", "愚蠢", "强大", "软弱"], note: "第25节：'天主的愚妄总比人智慧。'" }, en: { q: "8. Fill in the blank: 'The foolishness of God is _____ than men.'", options: ["Wiser", "More foolish", "Stronger", "Weaker"], note: "Verse 25: 'The foolishness of God is wiser than men'." } },
        { id: 29, diff: 'hard', correct: 1, zh: { q: "9. 天主选了世上“不存在的”，是为了废除“存在的”，目的是？", options: ["显示祂的愤怒", "使凡有血肉的，在天主前无所夸耀", "让世界陷入混乱", "惩罚魔鬼"], note: "第29节：'为使凡有血肉的，在天主前无所夸耀。'" }, en: { q: "9. God chose things that 'are not' to bring to nothing things that 'are', so that...?", options: ["He shows anger", "No human might boast in God's presence", "Create chaos", "Punish the devil"], note: "Verse 29: 'So that no human being might boast in the presence of God'." } },
        { id: 30, diff: 'hard', correct: 3, zh: { q: "10. 保禄提到“关于基督的证据”已经在他们中间怎么了？", options: ["被遗忘", "被怀疑", "被拒绝", "确立/坚固"], note: "第6节：'关于基督的证据，已在你们中间确立了。'" }, en: { q: "10. Paul says the 'testimony about Christ' has been _____ among them?", options: ["Forgotten", "Doubted", "Rejected", "Confirmed"], note: "Verse 6: 'Even as the testimony about Christ was confirmed among you'." } }
    ];

    // --- Logic ---

    function toggleLanguage() {
        currentLang = currentLang === 'zh' ? 'en' : 'zh';
        updateUIText();
        if (currentDifficulty) {
            renderQuizList();
        }
    }

    function updateUIText() {
        const t = uiText[currentLang];
        
        // Common
        document.querySelector('.lang-switch').textContent = t.langBtn;
        
        // Welcome View
        document.getElementById('txt-title').textContent = t.title;
        document.getElementById('txt-subtitle').textContent = t.subtitle;
        document.getElementById('txt-select-diff').textContent = t.selectDiff;
        document.getElementById('btn-easy').innerHTML = `${t.btnEasy} <span>★ 10${currentLang==='zh'?'题':'Q'}</span>`;
        document.getElementById('btn-medium').innerHTML = `${t.btnMedium} <span>★★ 10${currentLang==='zh'?'题':'Q'}</span>`;
        document.getElementById('btn-hard').innerHTML = `${t.btnHard} <span>★★★ 10${currentLang==='zh'?'题':'Q'}</span>`;
        document.getElementById('btn-all').innerHTML = `${t.btnAll} <span>30${currentLang==='zh'?'题':'Q'}</span>`;
        document.getElementById('txt-footer-1').textContent = t.footer;

        // Quiz View
        document.getElementById('btn-back').textContent = t.btnBack;
        document.getElementById('txt-footer-2').textContent = t.footer;
        
        // Mode Label update
        if (currentDifficulty) {
            let diffLabel = "";
            if(currentDifficulty === 'easy') diffLabel = t.btnEasy;
            else if(currentDifficulty === 'medium') diffLabel = t.btnMedium;
            else if(currentDifficulty === 'hard') diffLabel = t.btnHard;
            else diffLabel = t.btnAll;
            document.getElementById('lbl-mode').textContent = diffLabel;
        }
    }

    function startQuiz(difficulty) {
        currentDifficulty = difficulty;
        document.getElementById('welcome-view').classList.add('view-hidden');
        document.getElementById('quiz-view').classList.remove('view-hidden');
        updateUIText();
        renderQuizList();
        window.scrollTo(0,0);
    }

    function goBack() {
        currentDifficulty = null;
        document.getElementById('welcome-view').classList.remove('view-hidden');
        document.getElementById('quiz-view').classList.add('view-hidden');
    }

    function renderQuizList() {
        const container = document.getElementById('quiz-list');
        container.innerHTML = ''; 
        const t = uiText[currentLang];

        const filteredQuestions = questionsData.filter(q => {
            if (currentDifficulty === 'all') return true;
            return q.diff === currentDifficulty;
        });

        if (filteredQuestions.length === 0) {
            container.innerHTML = `<div style="text-align:center; padding:40px; color:#666;">No questions found.</div>`;
            return;
        }

        filteredQuestions.forEach((item) => {
            const data = item[currentLang];
            const card = document.createElement('div');
            card.className = 'card';
            
            // Question Title
            const title = document.createElement('div');
            title.className = 'question-title';
            title.textContent = data.q;
            card.appendChild(title);

            // Options Container
            const grid = document.createElement('div');
            grid.className = 'options-grid';

            // Feedback Element
            const feedback = document.createElement('div');
            feedback.className = 'feedback-box';

            // Check State
            const userAnswer = userAnswers[item.id]; 
            const isAnswered = userAnswer !== undefined;

            data.options.forEach((optText, optIndex) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = optText;
                
                if (isAnswered) {
                    btn.disabled = true;
                    if (optIndex === item.correct) {
                        btn.classList.add('correct');
                    } else if (optIndex === userAnswer) {
                        btn.classList.add('wrong');
                    }
                }

                btn.onclick = function() {
                    handleAnswer(item.id, item.correct, optIndex, grid, feedback, item);
                };
                grid.appendChild(btn);
            });

            // Restore feedback if answered
            if (isAnswered) {
                const isCorrect = userAnswer === item.correct;
                if (isCorrect) {
                    feedback.innerHTML = `<strong>${t.correct}</strong><div class="explanation-text">${t.noteTitle} ${data.note}</div>`;
                    feedback.classList.add('show-correct');
                } else {
                    const correctText = data.options[item.correct];
                    feedback.innerHTML = `<strong>${t.wrong}</strong><br>${t.correctIs} <b>${correctText}</b><div class="explanation-text">${t.noteTitle} ${data.note}</div>`;
                    feedback.classList.add('show-wrong');
                }
            }

            card.appendChild(grid);
            card.appendChild(feedback);
            container.appendChild(card);
        });
    }

    function handleAnswer(qId, correctIndex, selectedIndex, grid, feedback, item) {
        const t = uiText[currentLang];
        const data = item[currentLang];

        userAnswers[qId] = selectedIndex;
        
        const allBtns = grid.querySelectorAll('button');
        allBtns.forEach(b => b.disabled = true);
        
        const clickedBtn = allBtns[selectedIndex];
        const correctBtn = allBtns[correctIndex];

        if (selectedIndex === correctIndex) {
            clickedBtn.classList.add('correct');
            feedback.innerHTML = `<strong>${t.correct}</strong><div class="explanation-text">${t.noteTitle} ${data.note}</div>`;
            feedback.classList.add('show-correct');
        } else {
            clickedBtn.classList.add('wrong');
            correctBtn.classList.add('correct');
            const correctText = data.options[correctIndex];
            feedback.innerHTML = `<strong>${t.wrong}</strong><br>${t.correctIs} <b>${correctText}</b><div class="explanation-text">${t.noteTitle} ${data.note}</div>`;
            feedback.classList.add('show-wrong');
        }
    }

    window.onload = function() {
        updateUIText();
    };
</script>

</body>
</html>
